include config.mk

all: libnctplot.so

autogenerated:
	mkdir -p autogenerated

functions.c: make_functions.pl functions.in.c function_wrappers.c | autogenerated
	./$<

function_wrappers.c: make_functions1.pl
	./$<

autogenerated/functions_NC_INT.c: make_functions.pl functions.in.c | autogenerated
	./$<

libnctplot.so: nctplot.o
	$(CC) -o $@ -shared $^ -lnctietue3 -lncurses -lSDL2 -ldl

colormaps.h: make_colormaps.sh colormaps
	./$<

nctplot.o: nctplot.c nctplot.h functions.c colormaps.h
	$(CC) $(CFLAGS) -o $@ -c $<

clean:
	rm -rf *.o autogenerated colormaps.h functions.c function_wrappers.c libnctplot.so

install: libnctplot.so
	cp libnctplot.so $(libdir)
	cp nctplot.h $(includedir)

uninstall:
	rm -f $(libdir)/libnctplot.so
	rm -f $(includedir)/nctplot.h
